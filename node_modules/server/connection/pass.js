const server = require ( 'server' );

const { spawn } = require ( 'child_process' );

const passer = module .exports = ( socket ) => {

socket .send ( 'Type an existing Pass or a command to generate new one ...' );

socket .once ( 'message', ( data ) => {

let pass;

if ( ! isNaN ( parseInt ( data ) ) ) {

pass = server .passes [ parseInt ( data ) ];

} else {

let argv = data .split ( ' ' );

pass = spawn ( argv [ 0 ], argv .slice [ 1 ] );

server .passes [ pass .pid ] = pass;

}
 
if ( pass )
socket .emit ( 'pass', pass );

else {

socket .send ( 'Incorrect Pass!' );

passer ( socket );

}

} );

};
